<!-- Reusable Navigation Bar Component -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="../index.html">
            <i class="fas fa-boxes me-2"></i>StockWise
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto" id="mainNavLinks">
                <!-- Navigation links will be injected here based on user role -->
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item">
                    <button class="btn btn-outline-light me-2" id="themeToggle" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                        aria-expanded="false">
                        <i class="fas fa-user me-1"></i><span id="currentUsername">User</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="profile.html">
                                <i class="fas fa-user-cog me-2"></i>Profile
                            </a></li>
                        <li><a class="dropdown-item" href="settings.html">
                                <i class="fas fa-cog me-2"></i>Settings
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#" id="logoutBtn">
                                <i class="fas fa-sign-out-alt me-2"></i>Logout
                            </a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
    // Initialize navbar based on current page and user role
    (function () {
        const currentPage = window.location.pathname.split('/').pop();
        const user = AuthManager.getCurrentUser();

        if (!user) {
            window.location.href = 'login.html';
            return;
        }

        // Update username
        document.getElementById('currentUsername').textContent = user.username;

        // Define navigation links based on role
        const navLinks = {
            admin: [
                { href: 'admin-dashboard.html', icon: 'tachometer-alt', text: 'Dashboard' },
                { href: 'products.html', icon: 'boxes', text: 'Products' },
                { href: 'suppliers.html', icon: 'truck', text: 'Suppliers' },
                { href: 'users.html', icon: 'users', text: 'Users' },
                { href: 'reports.html', icon: 'chart-bar', text: 'Reports' }
            ],
            user: [
                { href: 'user-dashboard.html', icon: 'tachometer-alt', text: 'Dashboard' },
                { href: 'products.html', icon: 'boxes', text: 'Products' },
                { href: 'stock-movement.html', icon: 'exchange-alt', text: 'Stock Movement' }
            ],
            staff: [
                { href: 'user-dashboard.html', icon: 'tachometer-alt', text: 'Dashboard' },
                { href: 'products.html', icon: 'boxes', text: 'Products' },
                { href: 'stock-movement.html', icon: 'exchange-alt', text: 'Stock Movement' }
            ]
        };

        // Get links for user role
        const links = navLinks[user.role] || navLinks.user;

        // Inject navigation links
        const navContainer = document.getElementById('mainNavLinks');
        navContainer.innerHTML = links.map(link => {
            const isActive = currentPage === link.href ? 'active' : '';
            return `
            <li class="nav-item">
                <a class="nav-link ${isActive}" href="${link.href}">
                    <i class="fas fa-${link.icon} me-1"></i>${link.text}
                </a>
            </li>
        `;
        }).join('');

        // Setup logout button
        document.getElementById('logoutBtn').addEventListener('click', function (e) {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                AuthManager.clearSession('User logout');
                window.location.href = '../index.html';
            }
        });
    })();
</script>